{% extends 'layout.html' %}
{% block title %}{{ post.titulo }}{% endblock %}
{% block body %}
<h1>{{ post.titulo }}</h1>
<p>
    <small>
        Publicado por {{ post.usuario.nombre }} 
        el {{ post.fecha_creacion.strftime('%d/%m/%Y %H:%M') }} 
        en {{ post.categoria.nombre }}
    </small>
</p>
<p>{{ post.contenido }}</p>

<hr>
<h3>Comentarios</h3>
{% for comentario in post.comentarios %}
    <div>
        <p>
            <strong>{{ comentario.usuario.nombre }}</strong> - 
            <small>{{ comentario.fecha_creacion.strftime('%d/%m/%Y %H:%M') }}</small>
        </p>
        <p>{{ comentario.texto }}</p>
    </div>
{% else %}
    <p>No hay comentarios aún.</p>
{% endfor %}

{% if session.get('usuario_id') %}
<hr>
<form method="POST">
    <textarea name="texto" placeholder="Escribe tu comentario aquí..." required></textarea>
    <br>
    <button type="submit">Comentar</button>
</form>
{% else %}
<p><a href="{{ url_for('login') }}">Inicia sesión</a> para comentar.</p>
{% endif %}
{% endblock %}